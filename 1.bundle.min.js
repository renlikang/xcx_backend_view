webpackJsonp([1],{670:[1505,1157],787:function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=(a(122),a(63)),s=r(l),u=(a(361),a(219)),c=r(u),d=function(){function e(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}(),f=a(1),p=r(f),m=function(e){function t(){return n(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),d(t,[{key:"render",value:function(){var e=this;return p.default.createElement("div",{className:"db-pagination"},p.default.createElement(c.default,{showQuickJumper:!0,selectComponentClass:s.default,total:this.props.total,showTotal:function(t){return"每页"+e.props.pageSize+"条, 共 "+t+" 条"},pageSize:this.props.pageSize,defaultCurrent:1,current:this.props.currentPage,onChange:this.props.parentHandlePageChange}))}}]),t}(p.default.PureComponent);t.default=m},788:function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,a){function r(n,i){try{var o=t[n](i),l=o.value}catch(e){return void a(e)}return o.done?void e(l):Promise.resolve(l).then(function(e){r("next",e)},function(e){r("throw",e)})}return r("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=(a(368),a(224)),u=r(s),c=(a(670),a(212)),d=r(c),f=(a(98),a(54)),p=r(f),m=(a(76),a(16)),h=r(m),g=(a(168),a(145)),y=r(g),b=(a(99),a(86)),v=r(b),x=(a(360),a(218)),w=r(x),k=function(){function e(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}(),S=a(1),C=r(S),R=a(33),T=r(R),E=a(87),O=r(E),P=a(147),M=(r(P),a(3)),N=r(M),_=a(794),D=r(_),I=a(382),j=r(I),F=a(228),K=r(F),z=a(123),L=a(30),V=r(L),U=T.default.getLogger("InnerTable"),A=new Array;A.ACCESSCONTROL="门禁",A.NULL="无继电器",A.RELAY="有继电器";var q=function(e){function t(){var e,a,r,n;i(this,t);for(var l=arguments.length,s=Array(l),u=0;u<l;u++)s[u]=arguments[u];return a=r=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),r.state={modalVisible:!1,modalTitle:"新增",modalInsert:!0,selectedRowKeys:[],data:[],previewVisible:!1,previewImages:[],componentModalVisible:!1,tableName:"",myFormComponent:void 0},r.onClickInsert=function(e){e.preventDefault(),r.setState({modalVisible:!0,modalTitle:"新增",modalInsert:!0},function(){return r.setFormData({})})},r.onClickUpdate=function(e){e.preventDefault(),r.singleRecordKey=void 0,r.keysToUpdate=void 0;var t={},a=r.state.selectedRowKeys.length>1,n=r.state.selectedRowKeys[0],i=!0,o=!1,l=void 0;try{for(var s,u=r.state.data[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value;if(c.key===n){var d=r.transformRawData(c,r.props.tableName,!0);Object.assign(t,d);break}}}catch(e){o=!0,l=e}finally{try{!i&&u.return&&u.return()}finally{if(o)throw l}}r.setFormData(t),a?r.setState({modalVisible:!1,modalTitle:"批量更新",modalInsert:!1},function(){return r.setFormData(t)}):r.setState({modalVisible:!0,modalTitle:"更新",modalInsert:!1},function(){return r.setFormData(t)})},r.onClickDelete=function(e){e.preventDefault(),w.default.confirm({title:r.state.selectedRowKeys.length>1?"确认批量删除":"确认删除",content:"当前被选中的行: "+r.state.selectedRowKeys.join(", "),onOk:function(){r.handleDelete()}})},r.onTableSelectChange=function(e){r.setState({selectedRowKeys:e})},r.hideModal=function(){r.setState({modalVisible:!1})},r.handleModalOk=function(){var e=!0;if(e){var t={},a=r.formComponent.getFieldsValue();for(var n in a)void 0!==a[n]&&null!==a[n]&&(n===r.primaryKey&&"string"==typeof a[n]||(a[n]instanceof Date?t[n]=a[n].format("yyyy-MM-dd HH:mm:ss"):N.default.isMoment(a[n])?t[n]=a[n].format("YYYY-MM-DD HH:mm:ss"):t[n]=a[n]));if(r.hideModal(),r.state.modalInsert)r.handleInsert(t);else if(r.singleRecordKey){var i=[];i.push(r.singleRecordKey),r.handleUpdate(t,i)}else r.handleUpdate(t)}},r.onClickImage=function(e){var t=[];if(O.default.isString(e)&&e.length>0)t.push({url:e,alt:"图片加载失败"});else if(e instanceof Array){var a=!0,n=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(a=(o=l.next()).done);a=!0){var s=o.value;t.push({url:s,alt:"图片加载失败"})}}catch(e){n=!0,i=e}finally{try{!a&&l.return&&l.return()}finally{if(n)throw i}}}t.length>0&&r.setState({previewVisible:!0,previewImages:t})},r.cancelPreview=function(){r.setState({previewVisible:!1})},r.onSingleRecordUpdate=function(e,t){var a=r.transformTableDataToForm(e);r.singleRecordKey=e[r.primaryKey],t?r.keysToUpdate=new Set(t):r.keysToUpdate=void 0,r.setState({modalVisible:!0,modalTitle:"更新",modalInsert:!1},function(){return r.setFormData(a)})},r.onSingleRecordDelete=function(e){var t=e[r.primaryKey];w.default.confirm({title:"确认删除",content:"当前被选中的行: "+t,onOk:function(){var e=[];e.push(t),r.handleDelete(e)}})},r.onSingleRecordComponent=function(e,t,a){r.updateComponent=t,r.updateComponentRecord=e,r.updateComponentModalTitle=a,r.setState({componentModalVisible:!0})},r.handleComponentModalCancel=function(){r.setState({componentModalVisible:!1})},r.handleComponentModalOk=function(){if(r.setState({componentModalVisible:!1}),!r.updateComponentMounted)return void U.error("user-defined component does not mount");if(r.updateComponentMounted.getFieldsValue){var e=r.updateComponentMounted.getFieldsValue();if(e){var t=[];t.push(r.updateComponentRecord[r.primaryKey]),r.handleUpdate(e,t)}}},n=a,o(r,n)}return l(t,e),k(t,[{key:"componentWillMount",value:function(){this.parseTableSchema(this.props),this.parseTableData(this.props)}},{key:"getTags",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){var a,r,n,i,o,l,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.tableName,r=t.schema,n=t.tableLoading,i=t.tableConfig,o=v.default.loading("正在配置...",0),e.prev=2,e.next=5,(0,z.getTarget)();case 5:l=e.sent,o(),l.error?this.error(l.error.message):(l.forEach(function(e){e.key=e.id,e.value=e.desc}),V.default.configParams=l,s=j.default.getForm(a,r),this.setState({myFormComponent:s})),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(2),U.error("insert exception, %o",e.t0),o();case 14:case"end":return e.stop()}},e,this,[[2,10]])}));return e}()},{key:"componentWillReceiveProps",value:function(e){if(this.props.tableName!==e.tableName&&(this.parseTableSchema(e),this.formComponent=void 0),this.state.modalVisible=!1,this.state.modalTitle="新增",this.state.modalInsert=!0,this.state.selectedRowKeys=[],this.props.tableName!==e.tableName||!e.tableLoading){this.parseTableData(e);var t=this.props,a=t.tableName,r=t.schema,n=(t.tableLoading,t.tableConfig,j.default.getForm(a,r));this.setState({myFormComponent:n})}}},{key:"componentWillUnmount",value:function(){K.default.reset(),this.setState({myFormComponent:void 0})}},{key:"parseTableSchema",value:function(e){var t=e.tableName,a=e.schema,r=j.default.getTableSchema(t,a);this.primaryKey=r.primaryKey,this.fieldMap=r.fieldMap,this.tableSchema=K.default.bindRender(r.tableSchema,t,this)}},{key:"parseTableData",value:function(e){var t=this,a=e.tableName;e.schema,this.state.tableName=a;var r=[],n=0;e.data&&e.data.forEach(function(e){e=t.transformRawData(e,a),e.id?e.key=e.id:(e.key=n,n++),r.push(e)}),this.state.data=r}},{key:"transformRawData",value:function(e,t,a){return e.createdAt=(0,E.getSimpleDate)(e.createdAt),e}},{key:"transformRawDataToTable",value:function(e){var t={};for(var a in e)if(this.fieldMap.get(a).$$optionMap){var r=this.fieldMap.get(a).$$optionMap;if(e[a]instanceof Array){var n=[],i=!0,o=!1,l=void 0;try{for(var s,u=e[a][Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value;n.push(r[c])}}catch(e){o=!0,l=e}finally{try{!i&&u.return&&u.return()}finally{if(o)throw l}}t[a]=n.join(",")}else t[a]=r[e[a]]}else t[a]=e[a];return t.$$rawData=e,t}},{key:"transformRawDataToForm",value:function(e){var t={};for(var a in e)e[a]&&("datetime"===this.fieldMap.get(a).dataType?t[a]=(0,N.default)(e[a]):t[a]=e[a]);return t}},{key:"transformTableDataToForm",value:function(e){return this.transformRawDataToForm(e.$$rawData)}},{key:"setFormData",value:function(e){this.formComponent?(this.formComponent.resetFields(),e&&this.formComponent.setFieldsValue(e)):this.formInitData=e}},{key:"error",value:function(e){e&&void 0!=e&&""!=e&&y.default.error({message:"出错啦!",description:"请联系管理员, 错误信息: "+e,duration:0})}},{key:"handleInsert",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){var a,r,n,i,o,l,s,u,c,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=v.default.loading("正在新增...",0),e.prev=1,e.next=4,(0,z._insert)(t,this.props.tableName);case 4:if(r=e.sent,a(),r.error){e.next=34;break}for(y.default.success({message:"新增成功",description:r.id?"新增数据行 主键="+r.id:"",duration:3}),n=[],i=this.transformRawData(r,this.state.tableName),i.id?i.key=i.id:i.key=Math.floor(233333*Math.random()),n.push(i),o=!0,l=!1,s=void 0,e.prev=15,u=this.state.data[Symbol.iterator]();!(o=(c=u.next()).done);o=!0)d=c.value,n.push(d);e.next=23;break;case 19:e.prev=19,e.t0=e.catch(15),l=!0,s=e.t0;case 23:e.prev=23,e.prev=24,!o&&u.return&&u.return();case 26:if(e.prev=26,!l){e.next=29;break}throw s;case 29:return e.finish(26);case 30:return e.finish(23);case 31:this.setState({selectedRowKeys:[],data:n}),e.next=35;break;case 34:this.error(r.error.message);case 35:e.next=41;break;case 37:e.prev=37,e.t1=e.catch(1),U.error("insert exception, %o",e.t1),a();case 41:case"end":return e.stop()}},e,this,[[1,37],[15,19,23,31],[24,,26,30]])}));return e}()},{key:"handleUpdate",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){var a,r,n,i,o,l,s,u,c,d,f,p,m=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.state.selectedRowKeys;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=v.default.loading("正在更新...",0),e.prev=1,e.next=4,(0,z._update)(t,this.props.tableName);case 4:if(r=e.sent,a(),r.error){e.next=33;break}for(y.default.success({message:"更新成功",description:"更新"+r.id+"数据",duration:3}),n=this.transformRawData(r,this.props.tableName),i=[],o=new Set(m),l=!0,s=!1,u=void 0,e.prev=14,c=this.state.data[Symbol.iterator]();!(l=(d=c.next()).done);l=!0)f=d.value,o.has(f.key)?(p=Object.assign({},f,n),i.push(p)):i.push(f);e.next=22;break;case 18:e.prev=18,e.t0=e.catch(14),s=!0,u=e.t0;case 22:e.prev=22,e.prev=23,!l&&c.return&&c.return();case 25:if(e.prev=25,!s){e.next=28;break}throw u;case 28:return e.finish(25);case 29:return e.finish(22);case 30:this.setState({selectedRowKeys:[],data:i}),e.next=34;break;case 33:this.error(r.error.message);case 34:e.next=40;break;case 36:e.prev=36,e.t1=e.catch(1),U.error("update exception, %o",e.t1),a();case 40:case"end":return e.stop()}},e,this,[[1,36],[14,18,22,30],[23,,25,29]])}));return e}()},{key:"handleDelete",value:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(){var t,a,r,n,i,o,l,s,u,c,d,f=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.selectedRowKeys;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=v.default.loading("正在删除...",0),e.prev=1,a=this.state.data[f].articleId,e.next=5,(0,z.delArt)(a);case 5:if(r=e.sent,t(),r.error){e.next=33;break}for(y.default.success({message:"删除成功",description:"",duration:3}),n=[],i=new Set(f),o=!0,l=!1,s=void 0,e.prev=14,u=this.state.data[Symbol.iterator]();!(o=(c=u.next()).done);o=!0)d=c.value,i.has(d.key)||n.push(d);e.next=22;break;case 18:e.prev=18,e.t0=e.catch(14),l=!0,s=e.t0;case 22:e.prev=22,e.prev=23,!o&&u.return&&u.return();case 25:if(e.prev=25,!l){e.next=28;break}throw s;case 28:return e.finish(25);case 29:return e.finish(22);case 30:this.setState({selectedRowKeys:[],data:n}),e.next=34;break;case 33:this.error(r.error.message);case 34:e.next=40;break;case 36:e.prev=36,e.t1=e.catch(1),U.error("delete exception, %o",e.t1),t();case 40:case"end":return e.stop()}},e,this,[[1,36],[14,18,22,30],[23,,25,29]])}));return e}()},{key:"render",value:function(){var e=this,t=this.props,a=(t.tableName,t.schema,t.tableLoading),r=t.tableConfig,n=this.state.myFormComponent,i={selectedRowKeys:this.state.selectedRowKeys,onChange:this.onTableSelectChange},o=this.state.selectedRowKeys.length>0,l=this.state.selectedRowKeys.length>1,s=this.updateComponent;return C.default.createElement("div",null,C.default.createElement("div",{className:"db-table-button"},C.default.createElement(d.default,{offsetTop:8,target:function(){return document.getElementById("main-content-div")}},C.default.createElement(p.default.Group,null,r.showInsert&&C.default.createElement(p.default,{type:"primary",onClick:this.onClickInsert},C.default.createElement(h.default,{type:"plus-circle-o"})," 新增"),r.showUpdate&&C.default.createElement(p.default,{type:"primary",disabled:!o||!this.primaryKey||l,onClick:this.onClickUpdate},C.default.createElement(h.default,{type:"edit"})," ","修改"),r.showDelete&&C.default.createElement(p.default,{type:"primary",disabled:!o||!this.primaryKey,onClick:this.onClickDelete},C.default.createElement(h.default,{type:"delete"})," ",l?"批量删除":"删除"))),C.default.createElement(w.default,{title:this.state.modalTitle,visible:this.state.modalVisible,onOk:this.handleModalOk,onCancel:this.hideModal,maskClosable:!1,width:550},C.default.createElement(n,{ref:function(t){e.formComponent=t},initData:this.formInitData,forUpdate:!this.state.modalInsert,keysToUpdate:this.keysToUpdate}))),C.default.createElement(w.default,{visible:this.state.previewVisible,footer:null,onCancel:this.cancelPreview},C.default.createElement(D.default,{items:this.state.previewImages})),C.default.createElement(w.default,{title:this.updateComponentModalTitle,visible:this.state.componentModalVisible,onCancel:this.handleComponentModalCancel,onOk:this.handleComponentModalOk,maskClosable:!1},this.updateComponent&&C.default.createElement(s,{ref:function(t){e.updateComponentMounted=t},record:this.updateComponentRecord})),C.default.createElement(u.default,{rowSelection:i,columns:this.tableSchema,dataSource:this.state.data,pagination:!1,loading:a}))}}]),t}(C.default.PureComponent);t.default=q},789:function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,a){function r(n,i){try{var o=t[n](i),l=o.value}catch(e){return void a(e)}return o.done?void e(l):Promise.resolve(l).then(function(e){r("next",e)},function(e){r("throw",e)})}return r("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=(a(366),a(223)),u=r(s),c=(a(99),a(86)),d=r(c),f=(a(168),a(145)),p=r(f),m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},h=function(){function e(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}(),g=a(1),y=r(g),b=a(383),v=r(b),x=a(381),w=r(x),k=a(788),S=r(k),C=a(787),R=r(C),T=a(170),E=r(T);a(1187);var O=a(147),P=(r(O),a(87)),M=r(P),N=a(30),_=r(N),D=a(33),I=r(D),j=a(123),F=I.default.getLogger("DBTable"),K=function(e){function t(){var e,a,r,l,s=this;i(this,t);for(var u=arguments.length,c=Array(u),d=0;d<u;d++)c[d]=arguments[d];return a=r=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(c))),r.state={loadingSchema:!1,queryObj:{},data:[],tableLoading:!1,currentPage:0,pageSize:_.default.DBTable.pageSize||50,total:0},r.refresh=n(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r.inited){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,r.select(r.state.queryObj,r.state.currentPage,r.state.pageSize);case 4:t=e.sent,200===t.retCode?r.setState({currentPage:t.retData.page,data:t.retData.list,total:t.retData.total,tableLoading:!1}):r.error(t.retMsg);case 6:case"end":return e.stop()}},e,s)})),r.error=function(e){e&&void 0!==e&&p.default.error({message:"出错啦!",description:"请联系管理员, 错误信息: "+e,duration:0}),r.setState({tableLoading:!1})},r.handlePageChange=function(){var e=n(regeneratorRuntime.mark(function e(t){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.select(r.state.queryObj,t-1,r.state.pageSize);case 2:a=e.sent,200==a.retCode?r.setState({currentPage:a.retData.page,data:a.retData.list,total:a.retData.total,tableLoading:!1}):r.error(a.retMsg);case 4:case"end":return e.stop()}},e,s)}));return function(t){return e.apply(this,arguments)}}(),r.handleFormSubmit=function(){var e=n(regeneratorRuntime.mark(function e(t){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return F.debug("handleFormSubmit, queryObj = %o",t),e.next=3,r.select(t,0,r.state.pageSize);case 3:a=e.sent,200==a.retCode?r.setState({currentPage:a.retData.page,data:a.retData.list,total:a.retData.total,tableLoading:!1}):r.error(a.retMsg);case 5:case"end":return e.stop()}},e,s)}));return function(t){return e.apply(this,arguments)}}(),r.handleAdd=function(e){r.props.history.push("/login")},l=a,o(r,l)}return l(t,e),h(t,[{key:"componentWillMount",value:function(){var e=this;this.processQueryParams(),this.tryFetchSchema(this.props,function(t){e.updateTableState(t),e.state.loadingSchema&&e.setState({loadingSchema:!1},e.refresh)})}},{key:"componentDidMount",value:function(){this.state.loadingSchema||this.refresh()}},{key:"componentWillReceiveProps",value:function(e){var t=this;if(_.default.tabMode.enable!==!0){var a=this.props.location.action;if("PUSH"!==a){if(e.routes){var r=e.routes,n=r[r.length-1].tableName;if(n===this.tableName)return}this.tryFetchSchema(e,function(e){t.updateTableState(e),t.state.queryObj={},t.processQueryParams(),t.setState({data:[],tableLoading:!1,currentPage:0,total:0,loadingSchema:!1},t.refresh)})}}}},{key:"tryFetchSchema",value:function(){function e(e,a){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t,a){var r,n,i,o,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.routes,n=r.pop().tableName,!n){e.next=5;break}e.next=9;break;case 5:return F.error("can not find tableName, check your router config"),this.inited=!1,this.errorMsg="找不到表名, 请检查路由配置",e.abrupt("return");case 9:if(i=E.default.getTableConfig(n),o=E.default.getCacheSchema(n)){e.next=20;break}if(i.asyncSchema!==!0){e.next=19;break}return this.state.loadingSchema=!0,e.next=16,E.default.getRemoteSchema(n);case 16:o=e.sent,e.next=20;break;case 19:o=E.default.getLocalSchema(n);case 20:l=m({},o,{tableName:n,tableConfig:i}),a(l);case 22:case"end":return e.stop()}},e,this)}));return e}()},{key:"updateTableState",value:function(e){return this.tableName=e.tableName,this.tableConfig=e.tableConfig,e.querySchema?(this.querySchema=e.querySchema,e.dataSchema?(this.dataSchema=e.dataSchema,void(this.inited=!0)):(this.inited=!1,void(this.errorMsg="加载"+e.tableName+"表的dataSchema出错, 请检查配置"))):(this.inited=!1,void(this.errorMsg="加载"+e.tableName+"表的querySchema出错, 请检查配置"))}},{key:"processQueryParams",value:function(){var e=M.default.getAllQueryParams();Object.keys(e).length>0&&(this.state.queryObj=Object.assign({},this.state.queryObj,e))}},{key:"select",value:function(){function e(e,a,r){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t,a,r){var n,i,o,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object.assign({},t),n.page=a,n.size=r,i=d.default.loading("正在查询...",0),e.prev=4,this.setState({tableLoading:!0}),e.next=8,(0,j.tables)(n,this.tableName);case 8:return o=e.sent,i(),e.abrupt("return",o);case 13:return e.prev=13,e.t0=e.catch(4),F.error("select exception, %o",e.t0),i(),l={},l.success=!1,l.message="网络请求出错: "+e.t0.message,e.abrupt("return",Promise.resolve(l));case 21:case"end":return e.stop()}},e,this,[[4,13]])}));return e}()},{key:"render",value:function(){return!this.state.loadingSchema||this.notFirstRender&&(this.inited||this.errorMsg)?(this.notFirstRender=!0,this.inited?y.default.createElement(u.default,{spinning:this.state.loadingSchema,delay:500},"device"===this.tableName||"permission"===this.tableName?null:y.default.createElement(w.default,{parentHandleSubmit:this.handleFormSubmit,parentHandleSubmit2:this.handleAdd,schema:this.querySchema,tableConfig:this.tableConfig,tableName:this.tableName}),y.default.createElement(S.default,{data:this.state.data,tableLoading:this.state.tableLoading,schema:this.dataSchema,refresh:this.refresh,tableConfig:this.tableConfig,tableName:this.tableName}),y.default.createElement(R.default,{currentPage:this.state.currentPage,total:this.state.total,pageSize:this.state.pageSize,parentHandlePageChange:this.handlePageChange,tableConfig:this.tableConfig,tableName:this.tableName})):y.default.createElement(u.default,{tip:"loading schema...",spinning:this.state.loadingSchema,delay:500},y.default.createElement(v.default,{errorMsg:this.errorMsg}))):(this.notFirstRender=!0,y.default.createElement(u.default,{tip:"loading schema...",spinning:this.state.loadingSchema,delay:500},y.default.createElement("div",{style:{height:"150px",width:"100%"}})))}}]),t}(y.default.PureComponent);t.default=K},794:function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}(),s=a(1),u=r(s);a(1193);var c=function(e){function t(){var e,a,r,o;n(this,t);for(var l=arguments.length,s=Array(l),u=0;u<l;u++)s[u]=arguments[u];return a=r=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),r.state={previousIndex:0,currentIndex:0},r.slideLeft=function(){return r.slideToIndex(r.state.currentIndex-1)},r.slideRight=function(){return r.slideToIndex(r.state.currentIndex+1)},o=a,i(r,o)}return o(t,e),l(t,[{key:"componentWillMount",value:function(){this.navButton=u.default.createElement("span",{key:"navigation"},u.default.createElement("button",{type:"button",className:"image-gallery-left-nav",onClick:this.slideLeft}),u.default.createElement("button",{type:"button",className:"image-gallery-right-nav",onClick:this.slideRight}))}},{key:"componentWillReceiveProps",value:function(){this.state.currentIndex=0,this.state.previousIndex=0}},{key:"slideToIndex",value:function(e){var t=this.state.currentIndex,a=this.props.items.length-1,r=e;e<0?r=a:e>a&&(r=0),this.setState({previousIndex:t,currentIndex:r})}},{key:"renderItem",value:function(e){return u.default.createElement("div",{className:"image-gallery-image"},u.default.createElement("img",{src:e.url,alt:e.alt}),e.description&&u.default.createElement("span",{className:"image-gallery-description"},e.description))}},{key:"_getAlignmentClassName",value:function(e){var t=this.state.currentIndex,a="",r="left",n="center",i="right";switch(e){case t-1:a=" "+r;break;case t:a=" "+n;break;case t+1:a=" "+i}return this.props.items.length>=3&&(0===e&&t===this.props.items.length-1?a=" "+i:e===this.props.items.length-1&&0===t&&(a=" "+r)),a}},{key:"_getTranslateXForTwoSlide",value:function(e){var t=this.state,a=t.currentIndex,r=t.offsetPercentage,n=void 0===r?0:r,i=t.previousIndex,o=-100*a,l=o+100*e+n;return n>0?this.direction="left":n<0&&(this.direction="right"),0===a&&1===e&&n>0?l=-100+n:1===a&&0===e&&n<0&&(l=100+n),a!==i?0===i&&0===e&&0===n&&"left"===this.direction?l=100:1===i&&1===e&&0===n&&"right"===this.direction&&(l=-100):0===a&&1===e&&0===n&&"left"===this.direction?l=-100:1===a&&0===e&&0===n&&"right"===this.direction&&(l=100),l}},{key:"_getSlideStyle",value:function(e){var t=this.state,a=t.currentIndex,r=t.offsetPercentage,n=void 0===r?0:r,i=this.props.items,o=-100*a,l=i.length-1,s=o+100*e+n,u=1;e===a?u=3:e===this.state.previousIndex?u=2:0!==e&&e!==l||(u=0),i.length>2&&(0===a&&e===l?s=-100+n:a===l&&0===e&&(s=100+n)),2===i.length&&(s=this._getTranslateXForTwoSlide(e));var c="translate3d("+s+"%, 0, 0)";return{WebkitTransform:c,MozTransform:c,msTransform:c,OTransform:c,transform:c,zIndex:u,transition:"transform 450ms ease-out"}}},{key:"render",value:function(){var e=this,t=this.state.currentIndex,a=[],r=[];this.props.items.forEach(function(n,i){var o=e._getAlignmentClassName(i),l=u.default.createElement("div",{key:i,className:"image-gallery-slide"+o,style:e._getSlideStyle(i)},e.renderItem(n));a.push(l),r.push(u.default.createElement("button",{key:i,type:"button",className:"image-gallery-bullet "+(t===i?"active":""),onClick:function(t){return e.slideToIndex(i)}}))});var n=u.default.createElement("div",{className:"image-gallery-slide-wrapper"},this.props.items.length>1&&this.navButton,u.default.createElement("div",{className:"image-gallery-slides"},a),this.props.items.length>1&&u.default.createElement("div",{className:"image-gallery-bullets"},u.default.createElement("ul",{className:"image-gallery-bullets-container"},r)),this.props.items.length>1&&u.default.createElement("div",{className:"image-gallery-index"},u.default.createElement("span",{className:"image-gallery-index-current"},this.state.currentIndex+1),u.default.createElement("span",{className:"image-gallery-index-separator"}," / "),u.default.createElement("span",{className:"image-gallery-index-total"},this.props.items.length)));return u.default.createElement("section",{className:"image-gallery"},u.default.createElement("div",{className:"image-gallery-content"},n))}}]),t}(u.default.PureComponent);c.propTypes={items:u.default.PropTypes.array.isRequired},c.defaultProps={items:[]},t.default=c},1077:function(e,t,a){t=e.exports=a(276)(),t.push([e.id,".ant-affix{position:fixed;z-index:10}",""])},1078:function(e,t,a){t=e.exports=a(276)(),t.push([e.id,".ant-advanced-search-form{padding:16px 8px;background:#f8f8f8;border:1px solid #d9d9d9;border-radius:6px}.ant-advanced-search-form>.ant-row{position:relative;left:-6px}.ant-advanced-search-form .ant-btn+.ant-btn{margin-left:8px}.db-pagination{float:left}.db-pagination,.db-table-button{margin-top:8px;margin-bottom:8px}.ant-upload{margin-left:4px}",""])},1079:function(e,t,a){t=e.exports=a(276)(),t.push([e.id,'.image-gallery-left-nav:before,.image-gallery-right-nav:before{display:inline-block;font-family:anticon;speak:none;font-style:normal;font-weight:400;font-variant:normal;text-transform:none;text-rendering:auto;line-height:1;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.image-gallery{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent}.image-gallery-content{position:relative;line-height:0;top:0}.image-gallery-slide-wrapper{position:relative}.image-gallery-slide-wrapper.left,.image-gallery-slide-wrapper.right{display:inline-block;width:-13%}@media (max-width:768px){.image-gallery-slide-wrapper.left,.image-gallery-slide-wrapper.right{width:16%}}.image-gallery-left-nav,.image-gallery-right-nav{appearance:none;background-color:transparent;border:0;cursor:pointer;outline:none;position:absolute;z-index:4}.image-gallery-left-nav:before,.image-gallery-right-nav:before{color:#fff;line-height:.7;text-shadow:0 2px 2px #1a1a1a;transition:color .2s ease-out}.image-gallery-left-nav:hover:before,.image-gallery-right-nav:hover:before{color:#337ab7}@media (max-width:768px){.image-gallery-left-nav:hover:before,.image-gallery-right-nav:hover:before{color:#fff}}.image-gallery-left-nav,.image-gallery-right-nav{color:#fff;font-size:5em;padding:50px 3px;top:50%;transform:translateY(-50%)}.image-gallery-left-nav[disabled],.image-gallery-right-nav[disabled]{cursor:disabled;opacity:.6;pointer-events:none}@media (max-width:768px){.image-gallery-left-nav,.image-gallery-right-nav{font-size:3.4em}}@media (max-width:480px){.image-gallery-left-nav,.image-gallery-right-nav{font-size:2.4em}}.image-gallery-left-nav{left:0}.image-gallery-left-nav:before{content:"\\E620"}.image-gallery-right-nav{right:0}.image-gallery-right-nav:before{content:"\\E61F"}.image-gallery-slides{line-height:0;overflow:hidden;position:relative;white-space:nowrap}.image-gallery-slide{background:#fff;left:0;position:absolute;top:0;width:100%}.image-gallery-slide.center{position:relative}.image-gallery-slide img{width:100%}.image-gallery-slide .image-gallery-description{background:rgba(0,0,0,.4);bottom:70px;color:#fff;left:0;line-height:1;padding:10px 20px;position:absolute;white-space:normal}@media (max-width:768px){.image-gallery-slide .image-gallery-description{bottom:45px;font-size:.8em;padding:8px 15px}}.image-gallery-bullets{bottom:20px;left:0;margin:0 auto;position:absolute;right:0;width:80%;z-index:4}.image-gallery-bullets .image-gallery-bullets-container{margin:0;padding:0;text-align:center}.image-gallery-bullets .image-gallery-bullet{appearance:none;background-color:transparent;border:1px solid #fff;border-radius:50%;box-shadow:0 1px 0 #1a1a1a;cursor:pointer;display:inline-block;margin:0 5px;outline:none;padding:5px}@media (max-width:768px){.image-gallery-bullets .image-gallery-bullet{margin:0 3px;padding:3px}}@media (max-width:480px){.image-gallery-bullets .image-gallery-bullet{padding:2.7px}}.image-gallery-bullets .image-gallery-bullet.active{background:#fff}.image-gallery-index{background:rgba(0,0,0,.4);color:#fff;line-height:1;padding:10px 20px;position:absolute;right:0;top:0;z-index:4}@media (max-width:768px){.image-gallery-index{font-size:.8em;padding:5px 10px}}',""]);
},1157:function(e,t,a){var r=a(1077);"string"==typeof r&&(r=[[e.id,r,""]]),a(338)(r,{}),r.locals&&(e.exports=r.locals)},1187:[1561,1078],1193:[1561,1079],1561:function(e,t,a,r){var n=a(r);"string"==typeof n&&(n=[[e.id,n,""]]),a(338)(n,{}),n.locals&&(e.exports=n.locals)}});
//# sourceMappingURL=1.bundle.min.js.map